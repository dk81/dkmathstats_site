---
title: "Plotting Math Functions In R"
output: html_document
---

&nbsp;

Hi. I have played around with the ggplot2 package in R to create math functions plot. Here is some of my findings and experimental work. Make sure to load ggplot2 in R using `library(ggplot2)`.

&nbsp;

```{r}
library(ggplot2)
```

&nbsp;

### <u>Table Of Contents</u>

&nbsp;

* <a href="#refs">References</a>

* <a href="#parabola">A Parabola Example</a>

* <a href="#sine">A Sine Function Plot</a>

* <a href="#absolute">The Absolute Function</a>

* <a href="#root">A Square Root Plot</a>

* <a href="#reciprocal">The Reciprocal Function</a>

* <a href="#exponential">A Exponential Function Plot</a>

* <a href="#log">A Logarithmic Function Plot</a>

* <a href="#twoplots">An Example Of Combining Two Functions In A Plot</a>

&nbsp;

<a name="refs"></a>

### <u>References</u>

&nbsp;

* http://www.sthda.com/english/wiki/ggplot2-add-straight-lines-to-a-plot-horizontal-vertical-and-regression-lines

* R Graphics Cookbook by Winston Chang (2012)

&nbsp;

<a name="parabola"></a>

### <u>A Parabola Example</u>

&nbsp;

Recall that the parabola comes from $x^2$. In R, the quadratic function is made first. The ggplot() function is then used along with stat_function(fun = quadratic_fun).

&nbsp;


```{r, echo = TRUE}  
### 1) Parabola:

quadratic_fun <- function(x){
  x^2
}
```

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}  
# Basic Plot (Data frame for setting the range)
ggplot(data.frame(x = c(-15,15)), aes(x = x)) +
  stat_function(fun = quadratic_fun) + xlim(c(-15, 15))

```

&nbsp;

The above plot looks okay but it could use some labels. Here is an updated version of the above in the code and output below.

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}  
# Parabola Plot With Labels:

ggplot(data.frame(x = c(-15,15)), aes(x = data.frame(x = x))) +
  stat_function(fun = quadratic_fun) + xlim(c(-15, 15)) +
  labs(x = "\n x", y = "y \n") +
  theme(axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = 0, y = 200, parse = TRUE, size = 5, fontface = "bold",
           label="y == x^2")
```

&nbsp;

The axes labels have been changed through colour and size. To obtain the $y = x^2$ on the top, you need the `annotate()` function. With `annotate()` you can specify the positioning, text size, fontface and label names.

&nbsp;

---

<a name="sine"></a>

### <u>A Sine Function Plot</u>

&nbsp;

This example will be on the sine function or $y = \sin(x)$. The code is very similar to the parabola example above. Note that radians are used over degrees where $\pi$ is equal to 180 degrees or the numeric value of 3.14 (two decimals).

&nbsp;

```{r}
### 2) Sine Function:

sine_funct <- function(xrange){
  sin(xrange)
}
```

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
# Sine Graph Plot With Labels:

sinePlot <- ggplot(data.frame(x = c(-10*pi, 10*pi)), aes(x = x)) +
  stat_function(fun = sine_funct) + xlim(c(-5*pi, 5*pi)) + ylim(c(-3, 3)) +
  labs(x = "\n x", y = "y \n") +
  theme(axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = 0, y = 2.5, parse = TRUE, size = 5, fontface = "bold",
           label="y == sin(x)")

# Output the graph:
sinePlot
```

&nbsp;

An optional add-on would be adding the $y = 0$ line.

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
# Add a line y = 0 to sine plot:

sinePlot + geom_hline(yintercept = 0, linetype = "dotted", colour = "red")
```

&nbsp;

<a name="absolute"></a>

### <u>The Absolute Function</u>

&nbsp;

Here is an example of plotting the absolute function. Note that I used ifelse() for the function which is a condensed form of using if, else statements.

&nbsp;

```{r}
### 3) Absolute Function:

absolute_funct <- function(x){
  ifelse(x >=0, x, - x)
}
```

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}  
# Absolute Value Plot:

ggplot(data.frame(x = c(-10, 10)), aes(x = x)) +
  stat_function(fun = absolute_funct) + xlim(c(-15, 15)) +
  labs(x = "\n x", y = "y \n") +
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = 0, y = 13, parse = TRUE, size = 5, fontface = "bold",
           label="y == abs(x)")
```

&nbsp;

<a name="root"></a>

---

### <u>A Square Root Plot</u>

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
# 4) Square Root Function

sqroot_funct <- function(x){
  if (x >= 0) {
    sqrt(x)
  }
}
```

```{r, echo = TRUE, fig.width=4, fig.height=4}
# Square Root Plot With Labels:

ggplot(data.frame(x = c(0, 20)), aes(x = x)) +
  stat_function(fun = sqroot_funct) + xlim(c(0, 15)) + ylim(c(-1, 5)) +
  labs(x = "\n x", y = "y \n") +
  theme(axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = 10, y = 0, parse = TRUE, size = 5, fontface = "bold",
           label="y == sqrt(x)")
```

&nbsp;

<a name="reciprocal"></a>

---

### <u>The Reciprocal Function</u>

Here is my attempt on the reciprocal function $\dfrac{1}{x}$. I am not sure if it turned out right. Here is what I have.

```{r}
# 5) Reciprocal Function 

recip_funct <- function(x){
   1/x
}
```

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
# 1/x Plot With Labels:

recipPlot <- ggplot(data.frame(x = c(-20, 20)), aes(x = x)) +
  stat_function(fun = recip_funct) + xlim(c(-15, 15)) + ylim(c(-10, 10)) +
  labs(x = "\n x", y = "y \n") +
  theme(axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = 10, y = 5, parse = TRUE, size = 5, fontface = "bold",
           label="y == 1/x")

# Output:
recipPlot
```

You can add on asymptote lines at $y = 0$ and at $x = 0$.

```{r, echo = TRUE, fig.width=4, fig.height=4}
# Horizontal and Vertical Asymptotes:

recipPlot + geom_hline(yintercept = 0, linetype = "dotted", colour = "red") +
  geom_vline(xintercept = 0, linetype = "dotted", colour = "red")
```

&nbsp;

<a name="exponential"></a>

### <u>A Exponential Function Plot</u>

&nbsp;

```{r}
# 6) Exponential Function (e^x with e approx 2.718)

exp_funct <- function(x){
  exp(x)
}
```

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
# Exponential Plot With Labels:

expPlot <- ggplot(data.frame(x = c(-5, 5)), aes(x = x)) +
  stat_function(fun = exp_funct) + xlim(c(-7, 7)) + ylim(-1, 500) +
  labs(x = "\n x", y = "y \n") +
  theme(axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = -4, y = 400, parse = TRUE, size = 5, fontface = "bold",
           label="y == e^x")

# Output:

expPlot
```

&nbsp;

Axes lines can be added as well.

&nbsp;

```{r}
# Output with axes (and asymptotes):

expPlot + geom_hline(yintercept = 0, linetype = "dashed", colour = "darkgreen") +
  geom_vline(xintercept = 0, linetype = "dashed", colour = "darkgreen")
```

&nbsp;

<a name="log"></a>

### <u>A Logarithmic Function Plot</u>

&nbsp;

The inverse (reverse) of the exponential function is the logarithmic function.

```{r}
# 7) Logarithmic Function

log_funct <- function(x){
  log(x)
}
```

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
# Logarithmic Plot With Labels:

logPlot <- ggplot(data.frame(x = c(-0.5, 4)), aes(x = x)) +
  stat_function(fun = log_funct) + xlim(c(-1, 4)) + ylim(-15, 7) +
  labs(x = "\n x", y = "y \n") +
  theme(axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = 5, y = 3, parse = TRUE, size = 5, fontface = "bold",
           label="y == log(x)")

# Output:

logPlot
```

&nbsp;

Axes lines can be added as well here.

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
# Output with axes (and asymptotes):

logPlot + geom_hline(yintercept = 0, linetype = "dashed", colour = "darkgreen") +
  geom_vline(xintercept = 0, linetype = "dashed", colour = "darkgreen")
```

&nbsp;

<a name="twoplots"></a>

---

### <u>An Example Of Combining Two Functions In A Plot</u>

&nbsp;

In this example, the parabola $y = x^2$ and the $y = x$ line are put on the same plot.

&nbsp;

```{r, echo = TRUE, fig.width=4, fig.height=4}
### Combining Parabola and y = x line:

ggplot(data.frame(x = c(-5,5)), aes(x = data.frame(x = x))) +
  stat_function(fun = quadratic_fun, colour = "red") + xlim(c(-5, 5)) + ylim(c(-3,10)) +
  labs(x = "\n x", y = "y \n") +
  geom_abline(intercept = 0, slope = 1, linetype = "dashed", colour = "blue") +
  theme(axis.title.x = element_text(face="bold", colour="blue", size = 12),
        axis.title.y = element_text(face="bold", colour="blue", size = 12)) +
  annotate("text", x = -4, y = 8, parse = TRUE, size = 5, fontface = "bold",
           label="y == x^2") +
  annotate("text", x = 4.5, y = 2, parse = TRUE, size = 5, fontface = "bold",
           label="y == x") +
  geom_hline(yintercept = 0) +
  geom_vline(xintercept = 0)
```