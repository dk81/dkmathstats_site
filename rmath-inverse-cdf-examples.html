<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Examples Of The Inverse CDF Method In R [Monte Carlo Methods]</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">dkmathstats Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="mathstats_pages.html">Math &amp; Stats Pages</a>
</li>
<li>
  <a href="r-projects.html">R Programming</a>
</li>
<li>
  <a href="python_projects.html">Python Programming</a>
</li>
<li>
  <a href="toronto_math_tutoring.html">Math Tutoring In Toronto Area</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Examples Of The Inverse CDF Method In R [Monte Carlo Methods]</h1>

</div>


<p> </p>
<p>Hi. This is a follow up math and stats post on the The Inverse CDF Method. Examples on how this Monte Carlo simulation method works will be shown here. The main idea is that we generate various random variables with standard uniform random variables.</p>
<p> </p>
<div id="sections" class="section level3">
<h3><u>Sections</u></h3>
<p> </p>
<p><a href="#one">Example One - Generating Uniform Random Variables With Standard Uniform Random Variables</a></p>
<p><a href="#two">Example Two - Exponential Distribution</a></p>
<p><a href="#three">Example Three - Pareto Distribution</a></p>
<p><a href="#refs">References</a></p>
<p> </p>
<p><a name="one"></a></p>
</div>
<div id="example-one---generating-uniform-random-variables-with-standard-uniform-random-variables" class="section level3">
<h3><u>Example One - Generating Uniform Random Variables With Standard Uniform Random Variables</u></h3>
<p>Before doing any random number generation in R, the ggplot2 package is loaded by typing in <code>library(ggplot2)</code>.</p>
<p> </p>
<pre class="r"><code># Inverse CDF Monte Carlo Method Examples (With ggplot2)

library(ggplot2)
set.seed(100)</code></pre>
<p> </p>
<p>I also implement a random seed such that the results can be reproduced. Not using a random seed would yield different results everytime random numbers/variables are generated.</p>
<p>This first batch of code is about generating random numbers from a uniform distribution with a minimum of 2 and a maximum of 4. A plot (using ggplot2) is included.</p>
<p> </p>
<pre class="r"><code># Simulating 1 Million i.i.d Unif(a = 2, b = 4) R.Vs Case &amp; Plot

uniforms_ab_sim &lt;- runif(n = 10^6, min = 2, max = 4)

# Plot of simulated Unif(2, 4) random variables; Should be close to a rectangle:

ggplot(data = NULL, aes(uniforms_ab_sim)) +
  geom_histogram(binwidth = 0.1, boundary = 2) + 
  labs(x = &quot;\n Uniform Random Variable Value&quot;, y = &quot;Count \n&quot;, title = &quot;Simulated Unif(2, 4) \n Random Variables Histogram \n&quot;) +
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12))</code></pre>
<p><img src="rmath-inverse-cdf-examples_files/figure-html/unnamed-chunk-2-1.png" width="384" /></p>
<p> </p>
<p>It may not be obvious to see how there are 1 million observations in the plot but I will explain it here. Each bin has a binwidth of 0.1 so there would be 20 bins from 2.0 to 4.0. The height of the (near) rectangle is 50000. The one million comes from 20 x 50000.</p>
<p>This second batch of code is about generating the same uniform random variables with a minimum of 2 and a maximum of 4 but from the Inverse CDF Method. The generating formula is:</p>
<p> </p>
<p><span class="math display">\[a + (b - a)U\]</span></p>
<p> </p>
<p>where U is a standard uniform random variable with a minimum of 0 and a maximum of 1.</p>
<p>Since I want to generate uniform random variables with a minimum of 2 and a maximum of 4, I have <span class="math inline">\(a = 2\)</span> and <span class="math inline">\(b = 4\)</span>. The code and output can be found below.</p>
<p> </p>
<pre class="r"><code># The generating formula for generating Unif(a, b) ends up being: 
# F^(-1)(U)  = a + (b - a)U where U is a Unif(0, 1) random variable.
# Generating Unif(a = 2, b = 4) using Inverse CDF Method and Unif(0, 1):

unif_invCDFs &lt;- 2 + 2*runif(n = 10^6, min = 0, max = 1)

# Plot should be similar to the plot before.

ggplot(data = NULL, aes(unif_invCDFs)) +
  geom_histogram(binwidth = 0.1, boundary = 2) + 
  labs(x = &quot;\n Uniform Random Variable Value&quot;, y = &quot;Count \n&quot;, title = &quot;Simulated Uniform Random Variables \n From The Inverse CDF Method \n&quot;) +
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12))</code></pre>
<p><img src="rmath-inverse-cdf-examples_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p> </p>
<p>For the most part, the plot here is not much different from the plot above. The plots are not exactly the same due to randomness.</p>
<p> </p>
<p><a name="two"></a></p>
<hr />
<p> </p>
</div>
<div id="example-two---exponential-distribution" class="section level3">
<h3><u>Example Two - Exponential Distribution</u></h3>
<p> </p>
<p>Recall that from the previous post that we generated an exponential random variable with <span class="math inline">\(x &gt; 0\)</span> and the rate lambda was <span class="math inline">\(\lambda &gt; 0\)</span>. The continuous probability distribution of the exponential random variable is:</p>
<p> </p>
<p><span class="math display">\[\displaystyle f(x) = \lambda \text{e}^{-\lambda x}\]</span></p>
<p> </p>
<p>From finding the inverse of the cumulative distribution function (CDF) we came to the generating formula for X as <span class="math inline">\(X = -\dfrac{1}{\lambda} \text{ln}(1 - U)\)</span>.</p>
<p>Alternatively, we can use <span class="math inline">\(X = -\dfrac{\text{ln}(U)}{\lambda}\)</span> since <span class="math inline">\((1 - U) \sim \text{Unif}(0, 1)\)</span> from <span class="math inline">\(U \sim \text{Unif}(0,1)\)</span>.</p>
<p> </p>
<p><strong><u>R Code</u></strong></p>
<p> </p>
<p>We use this generating formula <span class="math inline">\(X\)</span> to simulate exponential random variables from standard uniform random variables. A sample size of 10000 is used and the rate/lambda is 5. The code is for simulating exponential random variables directly from the <code>rexp()</code> function R and from the Inverse CDF Method.</p>
<p> </p>
<pre class="r"><code>### Example Two:

# We generate exponential random variables from uniform random variables
# through the Inverse CDF Method.

# Exponential simulation in R:

lambdaRate = 5 #lambdaRate value can be changed accordingly

# Simulating exponential random variables with a sample size of 10000.

E &lt;- rexp(10000, lambdaRate)

# Plot of exponential random variables; Should be close to exponential decay.

ggplot(data = NULL, aes(E)) +
 geom_histogram(binwidth = 0.1, boundary = 2) + 
 labs(x = &quot;\n Exponential Random Variable Value&quot;, y = &quot;Count \n&quot;, title = &quot;Simulated Exponential \n Random Variables Histogram \n&quot;) +
 theme(plot.title = element_text(hjust = 0.5), 
 axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12),
 axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12))</code></pre>
<p><img src="rmath-inverse-cdf-examples_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#----------------

# Simulating Exponential Random Variables Using Unif(0,1) With Inverse CDF Method

U &lt;- runif(n = 10000, min = 0, max = 1) # Simulate Unif(0,1) r.v&#39;s
X &lt;- -(log(U)/lambdaRate) # Generating formula from Inverse CDF

# Plotting the simulation results:

ggplot(data = NULL, aes(X)) +
 geom_histogram(binwidth = 0.1, boundary = 2) + 
 labs(x = &quot;\n Exponential Random Variable Value&quot;, y = &quot;Count \n&quot;, 
 title = &quot;Exponential Random Variables \n From The Inverse CDF Method&quot;) +
 theme(plot.title = element_text(hjust = 0.5), 
 axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12),
 axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12))</code></pre>
<p><img src="rmath-inverse-cdf-examples_files/figure-html/unnamed-chunk-4-2.png" width="672" style="display: block; margin: auto;" /></p>
<p> </p>
<p>For the most part, the frequency distributions are quite similar. The Inverse CDF Method for approximating/simulating an exponential random variable does a good job from standard uniform random variables.</p>
<p> </p>
<p><a name="three"></a></p>
<hr />
</div>
<div id="example-three---pareto-distribution" class="section level3">
<h3><u>Example Three - Pareto Distribution</u></h3>
<p> </p>
<p>Despite people knowing about Pareto’s 80-20 rule, the Pareto distribution is not really discussed much in introductory probability &amp; statistics books (in my opinion).</p>
<p>Given the shape parameter <span class="math inline">\(k\)</span> and the scale parameter <span class="math inline">\(\lambda\)</span>, the Pareto distribution has a probability density function (pdf) of:</p>
<p> </p>
<p><span class="math display">\[f(x) = \dfrac{k \lambda^k}{x^{(k + 1)}} \text{ for } x &gt; \lambda\]</span></p>
<p> </p>
<p>The generating formula for the Pareto distribution is:</p>
<p> </p>
<p><span class="math display">\[\frac{\lambda}{U^{1/k}}\]</span></p>
<p> </p>
<p>with <span class="math inline">\(U\)</span> as the standard uniform random variable.</p>
<p>Details of finding this generating formula involves integration and some algebra which can be found here.</p>
<p>The code for generating Pareto random variables involves creating a function for the generating formula. This function allows the user to input the size of the generating sample and the parameter size for lambda and k. I show the code and plots for Pareto random variables for lambda and k being 1 and for lambda and k being 2.</p>
<p> </p>
<pre class="r"><code>### Example Three: Pareto Distribution Simulations

# Resources: http://www.math.wm.edu/~leemis/chart/UDR/PDFs/Pareto.pdf
# http://isites.harvard.edu/fs/docs/icb.topic1475777.files/stat110hw5solutions.pdf

# Inverse CDF Method for simulating Pareto rvs:

pareto_invCDF_funct &lt;- function(n = 1, lambda = 1, k = 1){
  unifs &lt;- runif(n, min = 0, max =  1) # Simulate standard uniforms.
  invCDF_formula &lt;- lambda/((1 -  unifs)^(1/k)) # lambda / ((1 - U))^(1/k)
  invCDF_formula &lt;- lambda/(unifs^(1/k)) # U is a standard uniform rv; 1 - U also std. uniform
  
  return(invCDF_formula)
}

pareto_11 &lt;- pareto_invCDF_funct(10000, lambda = 1, k = 1)


# Plot of simulated Pareto lambda = 1, k = 1 random variables; 

ggplot(data = NULL, aes(pareto_11)) + 
  geom_histogram(binwidth = 0.1) + xlim(c(0, 25)) +
  labs(x = &quot;\n Pareto Random Variable Value&quot;, y = &quot;Count \n&quot;, title = &quot;Simulated Pareto \n Random Variables Histogram \n&quot;) +
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12))</code></pre>
<pre><code>## Warning: Removed 408 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="rmath-inverse-cdf-examples_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Pareto with lambda = 2 and k = 2

pareto_22 &lt;- pareto_invCDF_funct(10000, lambda = 2, k = 2)


# Plot of simulated Pareto lambda = 2, k = 2 random variables; 

ggplot(data = NULL, aes(pareto_22)) + 
  geom_histogram(binwidth = 0.1) + xlim(c(0, 25)) +
  labs(x = &quot;\n Pareto Random Variable Value&quot;, y = &quot;Count \n&quot;, title = &quot;Simulated Pareto \n Random Variables Histogram \n&quot;) +
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;darkgreen&quot;, size = 12))</code></pre>
<pre><code>## Warning: Removed 49 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="rmath-inverse-cdf-examples_files/figure-html/unnamed-chunk-5-2.png" width="672" style="display: block; margin: auto;" /></p>
<p> </p>
<p><a name="refs"></a></p>
</div>
<div id="references" class="section level3">
<h3><u>References</u></h3>
<p> </p>
<ul>
<li>Financial Mathematics: A Comprehensive Treatment by Giuseppe Campolieti and Roman N. Makarov</li>
<li><a href="http://www.math.wm.edu/~leemis/chart/UDR/PDFs/Pareto.pdf" class="uri">http://www.math.wm.edu/~leemis/chart/UDR/PDFs/Pareto.pdf</a></li>
<li><a href="http://isites.harvard.edu/fs/docs/icb.topic1475777.files/stat110hw5solutions.pdf" class="uri">http://isites.harvard.edu/fs/docs/icb.topic1475777.files/stat110hw5solutions.pdf</a></li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
