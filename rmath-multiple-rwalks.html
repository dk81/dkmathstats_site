<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Creating Multiple Random Walks In R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">dkmathstats Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="mathstats_pages.html">Math &amp; Stats Pages</a>
</li>
<li>
  <a href="r-projects.html">R Programming</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Creating Multiple Random Walks In R</h1>

</div>


<p> </p>
<p>Hi there. This is a follow up to my page on Random Walks In R. The previous page was about generating a single random walk path and plotting it. In this page, the focus is on creating on multiple random walk paths.</p>
<p> </p>
<div id="sections" class="section level3">
<h3><u>Sections</u></h3>
<p> </p>
<p><a href="#rwalks">The Code For Multiple Random Walks In R</a></p>
<p><a href="#plot">Random Walk Paths Plot</a></p>
<p><a href="#replicate">Alternate Way By Using The replicate() Function</a></p>
<p><a href="#refs">References</a></p>
<p> </p>
<p><a name="rwalks"></a></p>
</div>
<div id="the-code-for-multiple-random-walks-in-r" class="section level3">
<h3><u>The Code For Multiple Random Walks In R</u></h3>
<p> </p>
<p>Create one random walk path is not too bad. When it comes to simulating multiple random walk paths, it gets somewhat tricky.</p>
<p>I first initialize some values such as the time and the number of random walk paths I want to simulate. In this example, I choose 8 for num_paths.</p>
<p>I also initialize my matrix full of zeroes with the number of rows equal to the number of paths and the number of columns being the time + 1 (I have to include the time at t = 0).</p>
<p>Using a for loop, I simulate the positions at each time point for each path. The for loop will start with the first path and go through all the time points and then it goes to the second path and so on.</p>
<p> </p>
<pre class="r"><code># Multiple Random Walk Paths:

# Resource: http://www.phytools.org/eqg/Exercise_4.1/
# https://stackoverflow.com/questions/17150183/plot-multiple-lines-in-one-graph

library(ggplot2)

# Using the cumsum() function to generate random walk more efficently:

time &lt;- 100
num_paths &lt;- 8

rw_paths &lt;- matrix(data = 0, nrow = num_paths, ncol = time + 1)

# Fill rows with each random walk path realization:

for (i in 1:num_paths){
   rw_paths[i, ] &lt;- c(0, cumsum(sample(x = c(-1, 1), size = time, prob = c(0.5, 0.5), replace = TRUE)))
}

rw_paths &lt;- data.frame(rw_paths)

# Check:

head(rw_paths)</code></pre>
<pre><code>##   X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11 X12 X13 X14 X15 X16 X17 X18 X19 X20
## 1  0 -1 -2 -1  0  1  2  3  4   5   4   3   2   1   2   3   2   3   2   1
## 2  0 -1 -2 -3 -4 -3 -4 -5 -4  -3  -4  -5  -6  -5  -6  -7  -8  -9  -8  -7
## 3  0 -1  0  1  2  3  2  1  0   1   0  -1   0   1   0  -1   0   1   0   1
## 4  0  1  0  1  2  3  4  5  4   3   2   1   0   1   2   1   2   3   2   1
## 5  0 -1  0 -1  0  1  0  1  0   1   2   3   2   1   0  -1   0   1   2   3
## 6  0 -1  0  1  0  1  2  3  4   5   6   7   8   9  10  11  10  11  12  11
##   X21 X22 X23 X24 X25 X26 X27 X28 X29 X30 X31 X32 X33 X34 X35 X36 X37 X38
## 1   2   1   2   1   2   3   2   1   2   1   0   1   2   3   4   5   6   5
## 2  -8  -9 -10  -9 -10  -9 -10 -11 -12 -13 -14 -13 -14 -13 -14 -13 -12 -11
## 3   2   3   4   3   4   5   6   5   4   5   6   7   8   9   8   9   8   7
## 4   2   3   4   3   4   3   4   3   4   5   4   3   2   3   4   3   2   3
## 5   4   5   6   7   6   7   8   7   8   9   8   9   8   7   6   5   6   7
## 6  12  11  10  11  12  11  12  13  12  11  10   9   8   9  10   9   8   9
##   X39 X40 X41 X42 X43 X44 X45 X46 X47 X48 X49 X50 X51 X52 X53 X54 X55 X56
## 1   6   7   6   7   8   9   8   7   6   5   6   7   8   7   8   7   8   7
## 2 -12 -13 -12 -13 -14 -15 -14 -15 -16 -17 -16 -17 -18 -19 -20 -21 -20 -19
## 3   8   9   8   7   8   7   8   9   8   9   8   7   8   9  10  11  10   9
## 4   4   5   4   5   4   5   4   3   2   1   2   1   0  -1  -2  -3  -4  -3
## 5   8   7   6   5   6   7   6   7   8   7   8   9   8   7   8   9   8   9
## 6  10   9   8   9   8   7   6   7   8   7   8   7   8   9   8   9  10   9
##   X57 X58 X59 X60 X61 X62 X63 X64 X65 X66 X67 X68 X69 X70 X71 X72 X73 X74
## 1   8   7   8   7   8   9   8   7   6   7   8   9   8   9  10   9   8   7
## 2 -20 -19 -18 -19 -18 -17 -16 -15 -16 -15 -16 -15 -14 -15 -14 -13 -14 -13
## 3  10   9  10   9   8   9  10   9  10  11  10   9  10  11  12  11  12  11
## 4  -4  -5  -4  -5  -6  -5  -6  -7  -6  -5  -4  -5  -6  -5  -6  -5  -4  -5
## 5  10   9   8   7   6   7   8   9  10  11  10   9  10   9  10  11  12  11
## 6   8   9   8   7   8   7   8   9  10   9   8   7   8   7   6   7   8   9
##   X75 X76 X77 X78 X79 X80 X81 X82 X83 X84 X85 X86 X87 X88 X89 X90 X91 X92
## 1   8   9  10   9   8   9   8   9  10   9   8   7   6   7   6   7   8   9
## 2 -14 -15 -14 -15 -14 -15 -14 -13 -12 -11 -12 -13 -12 -11 -10 -11 -10 -11
## 3  10   9  10  11  12  11  12  11  10   9   8   7   6   5   6   5   4   3
## 4  -6  -7  -6  -5  -6  -7  -8  -9 -10  -9 -10  -9  -8  -7  -8  -7  -8  -7
## 5  12  11  10  11  10  11  10  11  10  11  10  11  12  13  14  15  16  17
## 6   8   7   8   9  10  11  10   9  10  11  12  13  14  13  12  11  12  13
##   X93 X94 X95 X96 X97 X98 X99 X100 X101
## 1   8   7   6   5   4   3   4    5    6
## 2 -12 -11 -12 -13 -14 -15 -16  -15  -16
## 3   4   3   2   3   4   5   4    3    4
## 4  -8  -7  -6  -7  -6  -7  -8   -7   -6
## 5  16  15  16  15  16  17  18   17   18
## 6  12  13  12  13  14  13  14   13   14</code></pre>
<p> </p>
<p>From the check of <code>head(rw_paths)</code>, we have a wide formatted data set:</p>
<pre class="r"><code># Check:

head(rw_paths)</code></pre>
<pre><code>##   X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11 X12 X13 X14 X15 X16 X17 X18 X19 X20
## 1  0 -1 -2 -1  0  1  2  3  4   5   4   3   2   1   2   3   2   3   2   1
## 2  0 -1 -2 -3 -4 -3 -4 -5 -4  -3  -4  -5  -6  -5  -6  -7  -8  -9  -8  -7
## 3  0 -1  0  1  2  3  2  1  0   1   0  -1   0   1   0  -1   0   1   0   1
## 4  0  1  0  1  2  3  4  5  4   3   2   1   0   1   2   1   2   3   2   1
## 5  0 -1  0 -1  0  1  0  1  0   1   2   3   2   1   0  -1   0   1   2   3
## 6  0 -1  0  1  0  1  2  3  4   5   6   7   8   9  10  11  10  11  12  11
##   X21 X22 X23 X24 X25 X26 X27 X28 X29 X30 X31 X32 X33 X34 X35 X36 X37 X38
## 1   2   1   2   1   2   3   2   1   2   1   0   1   2   3   4   5   6   5
## 2  -8  -9 -10  -9 -10  -9 -10 -11 -12 -13 -14 -13 -14 -13 -14 -13 -12 -11
## 3   2   3   4   3   4   5   6   5   4   5   6   7   8   9   8   9   8   7
## 4   2   3   4   3   4   3   4   3   4   5   4   3   2   3   4   3   2   3
## 5   4   5   6   7   6   7   8   7   8   9   8   9   8   7   6   5   6   7
## 6  12  11  10  11  12  11  12  13  12  11  10   9   8   9  10   9   8   9
##   X39 X40 X41 X42 X43 X44 X45 X46 X47 X48 X49 X50 X51 X52 X53 X54 X55 X56
## 1   6   7   6   7   8   9   8   7   6   5   6   7   8   7   8   7   8   7
## 2 -12 -13 -12 -13 -14 -15 -14 -15 -16 -17 -16 -17 -18 -19 -20 -21 -20 -19
## 3   8   9   8   7   8   7   8   9   8   9   8   7   8   9  10  11  10   9
## 4   4   5   4   5   4   5   4   3   2   1   2   1   0  -1  -2  -3  -4  -3
## 5   8   7   6   5   6   7   6   7   8   7   8   9   8   7   8   9   8   9
## 6  10   9   8   9   8   7   6   7   8   7   8   7   8   9   8   9  10   9
##   X57 X58 X59 X60 X61 X62 X63 X64 X65 X66 X67 X68 X69 X70 X71 X72 X73 X74
## 1   8   7   8   7   8   9   8   7   6   7   8   9   8   9  10   9   8   7
## 2 -20 -19 -18 -19 -18 -17 -16 -15 -16 -15 -16 -15 -14 -15 -14 -13 -14 -13
## 3  10   9  10   9   8   9  10   9  10  11  10   9  10  11  12  11  12  11
## 4  -4  -5  -4  -5  -6  -5  -6  -7  -6  -5  -4  -5  -6  -5  -6  -5  -4  -5
## 5  10   9   8   7   6   7   8   9  10  11  10   9  10   9  10  11  12  11
## 6   8   9   8   7   8   7   8   9  10   9   8   7   8   7   6   7   8   9
##   X75 X76 X77 X78 X79 X80 X81 X82 X83 X84 X85 X86 X87 X88 X89 X90 X91 X92
## 1   8   9  10   9   8   9   8   9  10   9   8   7   6   7   6   7   8   9
## 2 -14 -15 -14 -15 -14 -15 -14 -13 -12 -11 -12 -13 -12 -11 -10 -11 -10 -11
## 3  10   9  10  11  12  11  12  11  10   9   8   7   6   5   6   5   4   3
## 4  -6  -7  -6  -5  -6  -7  -8  -9 -10  -9 -10  -9  -8  -7  -8  -7  -8  -7
## 5  12  11  10  11  10  11  10  11  10  11  10  11  12  13  14  15  16  17
## 6   8   7   8   9  10  11  10   9  10  11  12  13  14  13  12  11  12  13
##   X93 X94 X95 X96 X97 X98 X99 X100 X101
## 1   8   7   6   5   4   3   4    5    6
## 2 -12 -11 -12 -13 -14 -15 -16  -15  -16
## 3   4   3   2   3   4   5   4    3    4
## 4  -8  -7  -6  -7  -6  -7  -8   -7   -6
## 5  16  15  16  15  16  17  18   17   18
## 6  12  13  12  13  14  13  14   13   14</code></pre>
<p> </p>
<p>Instead of this wide format, I would like the time points as rows and the paths going down by column. In R, I add a time = 0 column and I transpose this wide format into a long format. (Transpose comes from linear algebra which means to switch rows with columns and vice versa.)</p>
<p> </p>
<pre class="r"><code># Transpose and add times column (Transpose = switch rows with columns and viceversa):

rw_paths_t &lt;- cbind(Time = 0:time, t(rw_paths))

head(rw_paths_t)</code></pre>
<pre><code>##    Time                      
## X1    0  0  0  0 0  0  0 0  0
## X2    1 -1 -1 -1 1 -1 -1 1 -1
## X3    2 -2 -2  0 0  0  0 0 -2
## X4    3 -1 -3  1 1 -1  1 1 -1
## X5    4  0 -4  2 2  0  0 2  0
## X6    5  1 -3  3 3  1  1 3 -1</code></pre>
<p> </p>
<p>The columns after Time have no titles. This can be fixed easily. I also remove the row names with the X1, X2, etc.</p>
<p> </p>
<pre class="r"><code># Rename columns: Each column represents the path and the values are the positions at time t:

for (i in 1:num_paths){
  colnames(rw_paths_t)[i + 1] &lt;- paste0(&quot;Path_&quot;, i)
}

# Remove row names, have them blank

rownames(rw_paths_t) &lt;- NULL


# Convert to data.frame for gather().

rw_paths_t &lt;- data.frame(rw_paths_t)</code></pre>
<p> </p>
<p>Here is another check.</p>
<p> </p>
<pre class="r"><code>head(rw_paths_t)</code></pre>
<pre><code>##   Time Path_1 Path_2 Path_3 Path_4 Path_5 Path_6 Path_7 Path_8
## 1    0      0      0      0      0      0      0      0      0
## 2    1     -1     -1     -1      1     -1     -1      1     -1
## 3    2     -2     -2      0      0      0      0      0     -2
## 4    3     -1     -3      1      1     -1      1      1     -1
## 5    4      0     -4      2      2      0      0      2      0
## 6    5      1     -3      3      3      1      1      3     -1</code></pre>
<p> </p>
<p>This table looks nice and can be easily read. The downside of it is that it’s not usable for plotting in ggplot2. I want to reformat the data from a wide format to a long format where I have a column stating which path the position value goes with at each time point.</p>
<p>To do this, I use <code>tidyr</code>. (dplyr is used for the %&gt;% pipe operator).</p>
<p> </p>
<pre class="r"><code># Wide Format To Long Format Data:

library(tidyr)
library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     select</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>rw_paths2 &lt;- rw_paths_t %&gt;% gather(Path, Position, -Time)

# Check:

head(rw_paths2)</code></pre>
<pre><code>##   Time   Path Position
## 1    0 Path_1        0
## 2    1 Path_1       -1
## 3    2 Path_1       -2
## 4    3 Path_1       -1
## 5    4 Path_1        0
## 6    5 Path_1        1</code></pre>
<p> </p>
<p>In the <code>gather()</code> function from tidyr, I leave the time column alone. The Path_1, Path_2 up to Path_8 column names are now values under the new Path column. The values under Path_1, Path_2 up to Path_8 are now values in this new column called Position. These values correspond to the Path value and to the time point.</p>
<p> </p>
<p><a name="plot"></a></p>
</div>
<div id="random-walk-paths-plot" class="section level3">
<h3><u>Random Walk Paths Plot</u></h3>
<p> </p>
<p>After generating our random walk paths and data formatting, the random walk paths can be plotted in R with ggplot2.</p>
<p> </p>
<pre class="r"><code># Ggplot with time on horizontal axis, and running total/position on vertical axis.

ggplot(rw_paths2, aes(x = Time, y = Position, group = Path)) + 
  geom_line() +
  labs(x = &quot;\n Time (Seconds)&quot;, y = &quot;Position \n&quot;, title = paste0(&quot;Random Walk Paths With &quot;, time, &quot; Steps \n&quot;)) + 
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12)) +
  geom_hline(yintercept = 0, colour = &quot;red&quot;, linetype = &quot;dashed&quot;)</code></pre>
<p><img src="rmath-multiple-rwalks_files/figure-html/unnamed-chunk-7-1.png" width="384" /></p>
<p> </p>
<p>For different coloured paths add in <code>colour = Path</code> in the <code>aes()</code> part in <code>ggplot()</code>.</p>
<p> </p>
<pre class="r"><code># If I want different colours for each path I would add colour = Path in aes().

ggplot(rw_paths2, aes(x = Time, y = Position, group = Path, colour = Path)) + 
  geom_line() +
  labs(x = &quot;\n Time (Seconds)&quot;, y = &quot;Position \n&quot;, title = paste0(&quot;Random Walk Paths With &quot;, time, &quot; Steps \n&quot;)) + 
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12)) +
  geom_hline(yintercept = 0, colour = &quot;red&quot;, linetype = &quot;dashed&quot;)</code></pre>
<p><img src="rmath-multiple-rwalks_files/figure-html/unnamed-chunk-8-1.png" width="384" /></p>
<p> </p>
<p><a name="replicate"></a></p>
</div>
<div id="alternate-way-by-using-the-replicate-function" class="section level3">
<h3><u>Alternate Way By Using The replicate() Function</u></h3>
<p> </p>
<p>Instead of using a for loop for generating multiple random walk paths, the <code>replicate()</code> function can be used.</p>
<p>To show how <code>replicate()</code> works, here is an example. I use the <code>replicate()</code> function to simulate 8 standard uniform random variables 10 times.</p>
<p>Each of the ten replications are in columns.</p>
<p>The R code for multiple random walks is pretty similar to the one in the previous section. The for loop section has been modified for the <code>replicate()</code> function.</p>
<p> </p>
<pre class="r"><code># Replicate example: replicate(n = 10, runif(n = 8))

# Replicate function version:

library(ggplot2)

# Using the cumsum() function to generate random walk more efficently:

time &lt;- 100
num_paths &lt;- 8

rw_paths &lt;- matrix(data = 0, nrow = time + 1, ncol = num_paths)
 
# Fill rows with each random walk path realization with replicate():

rw_paths &lt;- replicate(num_paths, c(0, cumsum(sample(x = c(-1, 1), size = time, prob = c(0.5, 0.5), replace = TRUE))))

rw_paths &lt;- data.frame(rw_paths)

# Check:
 
head(rw_paths)</code></pre>
<pre><code>##   X1 X2 X3 X4 X5 X6 X7 X8
## 1  0  0  0  0  0  0  0  0
## 2  1 -1  1 -1  1 -1 -1 -1
## 3  0  0  2 -2  0 -2  0 -2
## 4 -1 -1  3 -3  1 -1  1 -3
## 5  0 -2  2 -2  0  0  0 -4
## 6  1 -1  3 -1 -1  1 -1 -3</code></pre>
<pre class="r"><code># Add times column (No need to transpose here):

rw_paths &lt;- cbind(Time = 0:time, rw_paths)

head(rw_paths)</code></pre>
<pre><code>##   Time X1 X2 X3 X4 X5 X6 X7 X8
## 1    0  0  0  0  0  0  0  0  0
## 2    1  1 -1  1 -1  1 -1 -1 -1
## 3    2  0  0  2 -2  0 -2  0 -2
## 4    3 -1 -1  3 -3  1 -1  1 -3
## 5    4  0 -2  2 -2  0  0  0 -4
## 6    5  1 -1  3 -1 -1  1 -1 -3</code></pre>
<p> </p>
<p>The neat part with replicate is that there is no need to transpose this time around. Here is the rest of the code before plotting. (This code section is pretty much the same as before.)</p>
<p> </p>
<pre class="r"><code># Rename columns: p_t which is position at time t.

for (i in 1:num_paths){
  colnames(rw_paths)[i + 1] &lt;- paste0(&quot;Path_&quot;, i)
}

# Remove row names, have them blank

rownames(rw_paths) &lt;- NULL

# Convert to data.frame for gather().

rw_paths &lt;- data.frame(rw_paths)

# Wide Format To Long Format Data:

library(tidyr)
library(dplyr)

rw_paths2 &lt;- rw_paths %&gt;% gather(Path, Position, -Time)

# Check:

head(rw_paths2)</code></pre>
<pre><code>##   Time   Path Position
## 1    0 Path_1        0
## 2    1 Path_1        1
## 3    2 Path_1        0
## 4    3 Path_1       -1
## 5    4 Path_1        0
## 6    5 Path_1        1</code></pre>
<pre class="r"><code>tail(rw_paths2)</code></pre>
<pre><code>##     Time   Path Position
## 803   95 Path_8       -1
## 804   96 Path_8        0
## 805   97 Path_8        1
## 806   98 Path_8        2
## 807   99 Path_8        1
## 808  100 Path_8        2</code></pre>
<pre class="r"><code>dim(rw_paths2)</code></pre>
<pre><code>## [1] 808   3</code></pre>
<p> </p>
<p>Here is the code and output of the plots.</p>
<p> </p>
<pre class="r"><code># Ggplot with time on horizontal axis, and running total/position on vertical axis.

ggplot(rw_paths2, aes(x = Time, y = Position, group = Path)) + 
  geom_line() +
  labs(x = &quot;\n Time (Seconds)&quot;, y = &quot;Position \n&quot;, title = paste0(&quot;Random Walk Paths With &quot;, time, &quot; Steps \n&quot;)) + 
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12)) +
  geom_hline(yintercept = 0, colour = &quot;red&quot;, linetype = &quot;dashed&quot;)</code></pre>
<p><img src="rmath-multiple-rwalks_files/figure-html/unnamed-chunk-11-1.png" width="384" /></p>
<pre class="r"><code># If I want different colours for each path I would add colour = Path in aes().

ggplot(rw_paths2, aes(x = Time, y = Position, group = Path, colour = Path)) + 
  geom_line() +
  labs(x = &quot;\n Time (Seconds)&quot;, y = &quot;Position \n&quot;, title = paste0(&quot;Random Walk Paths With &quot;, time, &quot; Steps \n&quot;)) + 
  theme(plot.title = element_text(hjust = 0.5), 
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&quot;blue&quot;, size = 12)) +
  geom_hline(yintercept = 0, colour = &quot;red&quot;, linetype = &quot;dashed&quot;)</code></pre>
<p><img src="rmath-multiple-rwalks_files/figure-html/unnamed-chunk-11-2.png" width="384" /></p>
<p> </p>
<p><a name="refs"></a></p>
</div>
<div id="references" class="section level3">
<h3><u>References</u></h3>
<p> </p>
<ul>
<li><a href="http://www.phytools.org/eqg/Exercise_4.1/" class="uri">http://www.phytools.org/eqg/Exercise_4.1/</a></li>
<li><a href="https://stackoverflow.com/questions/17150183/plot-multiple-lines-in-one-graph" class="uri">https://stackoverflow.com/questions/17150183/plot-multiple-lines-in-one-graph</a></li>
<li>Hands-On Programming With R By Garrett Grolemund</li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
